{"version":3,"sources":["file:///E:/myCocosGame/cocosCreator/myYoumingArcher/assets/script/framework/sdkUtil.ts"],"names":["SdkUtil","sys","native","PlayerData","StorageManager","customEventStatistics","eventType","objParams","toString","isNewBee","instance","platform","window","wx","cocosAnalytics","isInited","console","log","CACustomEvent","onStarted","vibrateShort","isEnableVibrate","getGlobalData","now","Date","vibratePreTime","vibrateInterval","isNative","reflection","callStaticMethod","success","result","fail","complete","shareGame","title","imageUrl","showShareMenu","withShareTicket","aldOnShareAppMessage","onShareAppMessage","imgAd","imgShare","isDebugMode","onlineInterval","isCheckOffline","isWatchVideoAd","isEnableMoving","isEnableZoom","arrLockDiary"],"mappings":"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","sourcesContent":["import { _decorator, SpriteFrame, sys,native} from \"cc\";\nimport { PlayerData } from \"./playerData\";\nimport { StorageManager } from './storageManager';\n//管理广告、分享、SDK相关内容的组件\nexport class SdkUtil {\n    public static platform: string = 'cocos'; //平台\n    public static imgAd: SpriteFrame = null!;\n    public static imgShare: SpriteFrame = null!;\n    public static isDebugMode: boolean = false;\n    public static onlineInterval: number = -1;\n    public static isEnableVibrate: boolean = true;\n    public static isCheckOffline: boolean = false; //登录后会检查是否展示登录界面，而且只检查一次\n    public static isWatchVideoAd: boolean = false;//是否正在播放广告\n    public static isEnableMoving: boolean = false;//是否允许屏幕上下移动\n    public static isEnableZoom: boolean = false;//是否允许屏幕缩放\n    public static arrLockDiary = [];//未解锁日记\n    public static vibrateInterval: number = 100;//两次震动之间的间隔,AppActivity里面的震动间隔也是100\n    public static vibratePreTime: number = 0;//上次震动时间\n\n    /**\n       * 自定义事件统计\n       *\n       * @param {string} eventType\n       * @param {object} objParams\n       */\n    public static customEventStatistics(eventType: string, objParams?: any) {\n        eventType = eventType.toString();\n        if (!objParams) {\n            objParams = {};\n        }\n\n        // console.log({'eventType': eventType},{'objParams': objParams});\n\n        objParams.isNewBee = PlayerData.instance.isNewBee;\n\n        if (this.platform === 'wx') {\n            //@ts-ignore\n            if (window['wx'] && window['wx']['aldSendEvent']) {\n                //@ts-ignore\n                window.wx['aldSendEvent'](eventType, objParams);\n            }\n        }\n\n        //@ts-ignore\n        if (this.platform === 'cocos' && window.cocosAnalytics && window.cocosAnalytics.isInited()) {\n            console.log(\"###统计\", eventType, objParams);\n            //@ts-ignore\n            window.cocosAnalytics.CACustomEvent.onStarted(eventType, objParams);\n        }\n    }\n\n    /**\n     * 调用震动\n     */\n    public static vibrateShort() {\n        let isEnableVibrate = StorageManager.instance.getGlobalData(\"vibration\") ?? true;\n\n        if (isEnableVibrate) {\n            let now = Date.now();\n\n            if (now - this.vibratePreTime >= this.vibrateInterval) {\n                if (sys.isNative) {\n                    native.reflection.callStaticMethod(\"com/cocos/game/AppActivity\", \"vibrator\", \"()V\");\n                //@ts-ignore\n                } else if (window.wx) {\n                //@ts-ignore\n                    wx.vibrateShort({\n                        success: (result: any) => {\n\n                        },\n                        fail: () => { },\n                        complete: () => { }\n                    });\n                }\n\n                this.vibratePreTime = now;\n            }\n        }\n    }\n\n    /**\n     * 微信分享\n     *\n     * @static\n     * @param {string} title\n     * @param {string} imageUrl\n     * @returns\n     * @memberof SdkUtil\n     */\n    public static shareGame(title: string, imageUrl: string) {\n        //@ts-ignore\n        if (!window.wx) {\n            return;\n        }\n\n        //@ts-ignore\n        wx.showShareMenu({\n            withShareTicket: true,\n            complete: () => {\n\n            }\n        });\n\n        //@ts-ignore\n        if (wx.aldOnShareAppMessage) {\n            //@ts-ignore\n            wx.aldOnShareAppMessage(function () {\n                // 用户点击了“转发”按钮\n                return {\n                    title: title,\n                    imageUrl: imageUrl,\n\n                };\n            });\n        } else {\n            //@ts-ignore\n            wx.onShareAppMessage(function () {\n                // 用户点击了“转发”按钮\n                return {\n                    title: title,\n                    imageUrl: imageUrl,\n\n                };\n            });\n        }\n    }\n}\n"]}