{"version":3,"sources":["file:///E:/myCocosGame/cocosCreator/myYoumingArcher/assets/script/fight/reward.ts"],"names":["_decorator","Component","Vec3","Quat","tween","Enum","EffectManager","Constant","ClientEvent","ResourceUtil","AudioManager","PoolManager","REWARD_TYPE","GOLD","HEART","ccclass","property","Reward","type","displayOrder","isDropOver","_trialScale","_trialPos","_tweenBounce","_curQuat","_isAutoRotate","_isInhaling","_oriScale","_ndParent","_ndTrial","_endTargetPos","_midTargetPos","_stepTargetPos","_upSpeedY","_downSpeedY","_curSpeedY","_oriWorPos","_isArriveMinPos","_rewardWorPos","_playerWorPos","_nextWorPos","_offsetPos","_targetWorPos","_totalFlyTime","_curFlyTime","_raiseTimes","_bouncePos","_bounceScale","onEnable","on","EVENT_TYPE","INHALE_REWARD","_inhaleReward","onDisable","off","start","init","time","ndParent","node","setScale","getScale","set","getWorldPosition","x","z","scheduleOnce","show","loadEffectRes","then","pf","instance","getNode","active","setPosition","Math","random","y","add3f","playSound","SOUND","GOLD_DROP","_checkMonsterClearOver","_closeTween","by","position","scale","easing","call","playParticle","stop","_checkInhaleOver","arrReward","children","filter","ndChild","name","length","console","log","GOLD_COLLECT","dispatchEvent","SHOW_WARP_GATE","update","deltaTime"],"mappings":"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AiB,OAAnD;AACH,WAFe,CAAhB;;AAIA,cAAI,CAACJ,SAAS,CAACK,MAAf,EAAuB;AACnBC,YAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA;AAAA;AAAA,8CAAa5B,QAAb,CAAsBQ,SAAtB,CAAgC;AAAA;AAAA,sCAASC,KAAT,CAAeoB,YAA/C;AACA;AAAA;AAAA,4CAAYC,aAAZ,CAA0B;AAAA;AAAA,sCAASnD,UAAT,CAAoBoD,cAA9C;AACH;AACJ;;AAEDC,QAAAA,MAAM,CAAEC,SAAF,EAAqB;AACvB,iBADuB,CAEvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACH;;AAlQiC,O;;;;;iBAKT5F,WAAW,CAACC,I","sourcesContent":["import { EffectManager } from './../framework/effectManager';\nimport { Util } from './../framework/util';\nimport { Constant } from './../framework/constant';\nimport { _decorator, Component, Node, Vec3, Quat, clamp, tween, Enum } from 'cc';\nimport { ClientEvent } from '../framework/clientEvent';\nimport { GameManager } from './gameManager';\nimport { ResourceUtil } from '../framework/resourceUtil';\nimport { AudioManager } from '../framework/audioManager';\nimport { PoolManager } from '../framework/poolManager';\n//奖品(奖励)脚本：金币和爱心\n\n//奖励类型\nconst REWARD_TYPE = Enum ({\n    GOLD: 1,//金币\n    HEART: 2,//爱心\n})\nconst { ccclass, property } = _decorator;\n@ccclass('Reward')\nexport class Reward extends Component {\n    @property({\n        type: REWARD_TYPE,\n        displayOrder: 1\n    })\n    public rewardType: any = REWARD_TYPE.GOLD;\n    public isDropOver: boolean = false;//是否已经落在地上\n\n    private _trialScale = new Vec3(3, 3, 3);//拖尾缩放\n    private _trialPos: Vec3 = new Vec3(0, -0.1, 0);//拖尾位置\n    private _tweenBounce: any = null!;//tween\n    private _curQuat: Quat = new Quat();//旋转\n    private _isAutoRotate: boolean = false;//是否自动旋转\n    private _isInhaling: boolean = false;//是否正在吸入中\n    private _oriScale: Vec3 = null!;//原始缩放大小\n    private _ndParent: Node = null!;//父亲节点\n    private _ndTrial: Node = null!;//拖尾节点\n    private _endTargetPos:Vec3 = new Vec3();//最终目标位置\n    private _midTargetPos: Vec3 = new Vec3();//中间位置\n    private _stepTargetPos: Vec3 = new Vec3();//下一次的位置\n    private _upSpeedY: number = 0.2;//上升最大速度\n    private _downSpeedY: number = 0.2;//下降最大速度\n    private _curSpeedY: number = 0;//当前速度\n    private _oriWorPos: Vec3 = new Vec3();//初始奖品世界坐标\n    private _isArriveMinPos: boolean = false;//已经到达中间位置\n    private _rewardWorPos: Vec3 = new Vec3();//当前奖品世界坐标\n    private _playerWorPos: Vec3 = new Vec3();//目标(主角)位置\n    private _nextWorPos: Vec3 = new Vec3();//下一个位置\n    private _offsetPos: Vec3 = new Vec3();//奖品和玩家之间的向量差\n    private _targetWorPos: Vec3 = new Vec3();//\n    private _totalFlyTime: number = 0;//奖品总飞行时间\n    private _curFlyTime: number = 0;//奖品当前飞行时间\n    private _raiseTimes: number = 1;//\n    private _bouncePos: Vec3 = new Vec3(0, 0.618, 0);//回收缓动高度\n    private _bounceScale: Vec3 = new Vec3(0.2, 0.2, 0.2);//回收缓动缩放\n\n    onEnable () {\n        ClientEvent.on(Constant.EVENT_TYPE.INHALE_REWARD, this._inhaleReward, this);\n    }\n\n    onDisable () {\n        ClientEvent.off(Constant.EVENT_TYPE.INHALE_REWARD, this._inhaleReward, this);\n    }\n\n    start () {\n\n    }\n\n    init (time: number, ndParent: Node) {\n        this._ndParent = ndParent;\n\n        if (this._oriScale) {\n            this.node.setScale(this._oriScale);\n        } else {\n            this._oriScale = this.node.getScale();\n        }\n\n        this._isAutoRotate = false;\n        this._isInhaling = false;\n        this._curSpeedY = this._upSpeedY;\n        this._oriWorPos.set(this.node.getWorldPosition().x, 1.65, this.node.getWorldPosition().z);\n        this._isArriveMinPos = false;\n        this.isDropOver = false;\n        this._totalFlyTime = 0;\n        this._curFlyTime = 0;\n        this._raiseTimes = 1;\n\n        //依次弹出奖品\n        this.scheduleOnce(()=>{\n            this.show();\n        }, time)\n\n        if (!this._ndTrial) {\n            ResourceUtil.loadEffectRes(\"trail/coinTrail\").then((pf: any)=>{\n                this._ndTrial = PoolManager.instance.getNode(pf, this.node);\n                this._ndTrial.active = false;\n                this._ndTrial.setScale(this._trialScale);\n                this._ndTrial.setPosition(this._trialPos);\n            });\n        } else {\n            this._ndTrial.active = false;\n        }\n    }\n\n    show () {\n        this.node.active = true;\n        let x = Math.random() * 6 - 3;//-3~3\n        let y = 4;//最高的高度4~4.5;\n        let z = Math.random() * 6 - 3;//-3~3\n        this._endTargetPos = this._endTargetPos.set(this._oriWorPos).add3f(x, 0, z);\n        this._midTargetPos = this._midTargetPos.set(this._oriWorPos).add3f(x/2, y, z/2);\n\n        // console.log(\"终点位置\", this._endTargetPos, \"中间位置\", this._midTargetPos);\n\n        AudioManager.instance.playSound(Constant.SOUND.GOLD_DROP);\n    }\n\n    /**\n     * 检查所有怪物是否已经击败，且奖品是否都全部掉落完毕\n     *\n     * @protected\n     * @memberof Reward\n     */\n    protected _checkMonsterClearOver () {\n        return\n        // let ndTarget = GameManager.getNearestMonster();\n\n        // if (!ndTarget) {\n        //     let arrReward = this._ndParent.children.filter((ndChild: Node)=>{\n        //         return ndChild.name === \"gold\" || ndChild.name === \"heart\";\n        //     })\n\n        //     let isAllDropOver = arrReward.every((ndReward: Node) => {\n        //         let scriptReward = ndReward.getComponent(Reward) as Reward;\n        //         return scriptReward.isDropOver === true;\n        //     });\n\n        //     if (isAllDropOver) {\n        //         console.log(\"###所有的奖品都已经掉落到地上了\");\n        //         ClientEvent.dispatchEvent(Constant.EVENT_TYPE.INHALE_REWARD);\n        //     }\n        // }\n    }\n\n    /**\n     * 玩家吸入奖品\n     *\n     * @protected\n     * @memberof Reward\n     */\n    protected _inhaleReward () {\n        //先弹跳\n        this._closeTween();\n        this._tweenBounce = tween(this.node)\n        .by(0.3, {position: this._bouncePos, scale: this._bounceScale}, {easing: \"bounceInOut\"})\n        .call(()=>{\n            //播放粒子特效，不要勾选粒子的prewarm属性，免得出现概率性没有播放拖尾\n            this._ndTrial.active = true;\n\n            EffectManager.instance.playParticle(this._ndTrial);\n\n            //再吸入\n            this._isInhaling = true;\n\n        })\n        .start()\n    }\n\n    protected _closeTween () {\n        if (this._tweenBounce) {\n            this._tweenBounce.stop();\n            this._tweenBounce = null!;\n        }\n    }\n\n    /**\n     *  检查所有奖品是否吸收完毕\n     *\n     * @protected\n     * @memberof Reward\n     */\n    protected _checkInhaleOver () {\n        let arrReward = this._ndParent.children.filter((ndChild: Node)=>{\n            return ndChild.name === \"gold\" || ndChild.name === \"heart\";\n        })\n\n        if (!arrReward.length) {\n            console.log(\"###已吸入全部奖品\");\n            AudioManager.instance.playSound(Constant.SOUND.GOLD_COLLECT);\n            ClientEvent.dispatchEvent(Constant.EVENT_TYPE.SHOW_WARP_GATE);\n        }\n    }\n\n    update (deltaTime: number) {\n        return\n        // //奖品上下弹跳\n        // if (!this.isDropOver) {\n        //     this._rewardWorPos.set(this.node.position);\n        //     //先抬高\n        //     if (!this._isArriveMinPos) {\n        //         this._stepTargetPos = this._rewardWorPos.lerp(this._midTargetPos, 0.03);\n        //         this._curSpeedY = Util.lerp(this._upSpeedY, this._curSpeedY, 0.03);\n        //         this._nextWorPos = this._nextWorPos.set(this._stepTargetPos).add3f(0, this._curSpeedY, 0);\n        //         this._nextWorPos.y = clamp(this._nextWorPos.y, 0, this._midTargetPos.y);\n        //         this.node.setPosition(this._nextWorPos);\n\n        //         // if (pos.equals(this._midTargetPos, 0.2)) {\n        //         if (this._nextWorPos.y >= this._midTargetPos.y) {\n        //             this._isArriveMinPos = true;\n        //             this._curSpeedY = 0;\n        //             // console.log(\"到达中间位置\");\n        //         }\n        //     } else {//后降落\n        //         this._stepTargetPos = this._rewardWorPos.lerp(this._endTargetPos, 0.02);\n        //         this._curSpeedY = Util.lerp(this._downSpeedY, this._curSpeedY, 0.05);\n        //         // console.log(\"_upSpeedY\", this._curSpeedY);\n        //         this._nextWorPos = this._nextWorPos.set(this._stepTargetPos).add3f(0, -this._curSpeedY, 0);\n        //         this._nextWorPos.y = clamp(this._nextWorPos.y, this._endTargetPos.y, this._midTargetPos.y);\n        //         this.node.setPosition(this._nextWorPos);\n\n        //         if (this._nextWorPos.equals(this._endTargetPos, 0.3)) {\n        //             this.isDropOver = true;\n        //             // console.log(\"到达地板上\");\n        //             this._isAutoRotate = true;\n        //             this._checkMonsterClearOver();\n        //         }\n        //     }\n        // }\n\n        // //奖品落地后自动旋转\n        // if (this._isAutoRotate) {\n        //     Quat.fromEuler(this._curQuat, 0, 120 * deltaTime, 0);\n        //     this.node.rotate(this._curQuat);\n        // }\n\n        // //奖品被玩家吸入\n        // if (this._isInhaling) {\n        //     //位置靠近玩家\n        //     this._playerWorPos.set(GameManager.scriptPlayer.node.worldPosition);\n        //     this._rewardWorPos.set(this.node.worldPosition);\n        //     //向量差\n        //     Vec3.subtract(this._offsetPos, this._playerWorPos, this._rewardWorPos);\n\n        //     if (!this._totalFlyTime) {\n        //         this._totalFlyTime = this._offsetPos.length() / 2;\n        //     }\n\n        //     // 由慢到快\n        //     this._raiseTimes += deltaTime;\n        //     let offset = Math.pow(this._raiseTimes, 0.5) - 1;\n        //     this._curFlyTime += deltaTime + offset;\n        //     this._curFlyTime = this._curFlyTime >= this._totalFlyTime ? this._totalFlyTime : this._curFlyTime;\n\n        //     let percent = Number((this._curFlyTime / this._totalFlyTime).toFixed(2));\n        //     // console.log(\"percent\", percent);\n\n        //     this._targetWorPos.set(this._rewardWorPos.x + this._offsetPos.x * percent, this._playerWorPos.y, this._rewardWorPos.z + this._offsetPos.z * percent);\n        //     this.node.setWorldPosition(this._targetWorPos);\n\n        //     let length = Util.getTwoPosXZLength(this._targetWorPos.x, this._targetWorPos.z, this._playerWorPos.x, this._playerWorPos.z);\n        //     // if (this._targetWorPos.equals(this._playerWorPos, 0.1)) {\n        //     if (length <= 0.1) {\n        //         this._isInhaling = false;\n        //         this._ndTrial.active = false;\n        //         PoolManager.instance.putNode(this.node);\n\n        //         if (this.rewardType === REWARD_TYPE.GOLD) {\n        //             GameManager.addGold();\n        //         } else if (this.rewardType === REWARD_TYPE.HEART) {\n        //             //回复5%的血量\n        //             let bloodNum = GameManager.scriptPlayer.curHpLimit * 0.05;\n        //             GameManager.scriptPlayer.addBlood(bloodNum);\n        //         }\n\n        //         this._checkInhaleOver();\n        //         // console.log(\"吸收奖品\");\n        //     }\n        // }\n    }\n}\n"]}