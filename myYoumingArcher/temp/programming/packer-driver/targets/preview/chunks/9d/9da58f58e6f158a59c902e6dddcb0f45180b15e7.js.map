{"version":3,"sources":["file:///E:/myCocosGame/cocosCreator/myYoumingArcher/assets/script/fight/gameManager.ts"],"names":["_decorator","Component","Node","CameraComponent","Vec3","SkeletalAnimationComponent","ParticleSystemComponent","AnimationComponent","find","ClientEvent","PlayerData","UIManager","Constant","LocalConfig","AudioManager","ccclass","property","GameManager","mapInfo","_dictMonsterSkill","_oriMainLightWorPos","_offsetWorPosMainLight","isWin","value","_isWin","isGameStart","dispatchEvent","EVENT_TYPE","ON_GAME_OVER","gameSpeed","console","log","_gameSpeed","refreshEffectSpeed","ndGameManager","ndPlayer","ndEffectManager","onEnable","on","ON_GAME_INIT","_onGameInit","_onGameOver","ON_GAME_PAUSE","_onGamePause","REFRESH_LEVEL","_refreshLevel","RECYCLE_ALL","_recycleAll","onDisable","off","start","mainCamera","camera","getComponent","scriptGameCamera","GameCamera","node","ndMapManager","ndLight","worldPosition","clone","isTesting","window","uiManager","instance","playerData","clientEvent","EffectManager","constant","level","playerInfo","totalLevel","getTableArr","length","queryByID","String","attackAddition","defenseAddition","hpAddition","moveSpeedAddition","attackSpeedAddition","HIDE_WARP_GATE","isGamePause","isGameOver","isRevive","arrMonster","ndBoss","existentNum","addFightTimes","pauseAll","showDialog","targetNode","arrAni","getComponentsInChildren","forEach","item","clips","clip","aniName","name","aniState","getState","speed","arrSkeletalAni","arrParticle","simulationSpeed","update","deltaTime","isFirstLoad"],"mappings":"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","sourcesContent":["// import { EffectManager } from './../framework/effectManager';\r\nimport { ClientEvent } from './../framework/clientEvent';\r\nimport { PlayerData } from './../framework/playerData';\r\n// import { Monster } from './monster';\r\nimport { UIManager } from './../framework/uiManager';\r\n// import { MapManager } from './mapManager';\r\nimport { _decorator, Component, Node, CameraComponent, Vec3, SkeletalAnimationComponent, ParticleSystemComponent, AnimationComponent, find, Prefab } from 'cc';\r\n// import { GameCamera } from './gameCamera';\r\n// import { Player } from './player';\r\nimport { ResourceUtil } from '../framework/resourceUtil';\r\nimport { Constant } from '../framework/constant';\r\nimport { LocalConfig } from '../framework/localConfig';\r\n// import { Boss } from './boss';\r\nimport { AudioManager } from '../framework/audioManager';\r\nimport { Util } from '../framework/util';\r\n// import { PoolManager } from '../framework/poolManager';\r\nconst { ccclass, property } = _decorator;\r\n//游戏管理脚本\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n    // @property(GameCamera)\r\n    // public camera: GameCamera = null!;//相机脚本\r\n\r\n    // @property({type: MapManager})\r\n    // public scriptMapManager: MapManager = null!;//地图脚本脚本\r\n\r\n    @property(Node)\r\n    public ndLight: Node = null!; //主光源\r\n\r\n    public mapInfo: any = {};//地图信息\r\n\r\n    public static mainCamera: CameraComponent | null = null;//相机脚本\r\n    public static isGameStart: boolean = false;//游戏是否开始\r\n    public static isGamePause: boolean = false;//游戏是否暂停\r\n    public static isGameOver: boolean = false;//游戏是否结束\r\n    // public static scriptPlayer: Player = null!;//玩家脚本\r\n    // public static scriptGameCamera: GameCamera;//相机脚本\r\n    public static ndPlayer: Node = null!;//玩家节点\r\n    public static ndBoss: Node = null!;//boss节点\r\n    // public static scriptBoss: Boss = null!;//boss脚本\r\n    public static ndGameManager: Node;//游戏全局管理节点\r\n    public static ndEffectManager: Node = null!;//特效节点\r\n    public static ndMapManager: Node = null!;//地图节点\r\n    public static isRevive: boolean = false;//玩家是否复活\r\n    public static isTesting: boolean = true;//是否开启测试代码\r\n    public static isFirstLoad: boolean = false;//是否首次加载\r\n    public static arrMonster: Node[] = []; //小怪、boss数组\r\n    public static existentNum: number = 0;//本层加载的npc、大爱心现存数量（怪物不会和npc、大爱心同时出现，配置表格需注意）\r\n    //本层敌人加成\r\n    public static attackAddition: number = 1;//本层敌人攻击加成\r\n    public static defenseAddition: number = 1;//本层敌人防御加成\r\n    public static hpAddition: number = 1;//本层敌人生命加成\r\n    public static moveSpeedAddition: number = 1;//本层敌人移速加成\r\n    public static attackSpeedAddition: number = 1;//本层敌人攻速加成\r\n\r\n    private _dictMonsterSkill: any = {};//已经预加载的敌人技能\r\n    private _oriMainLightWorPos: Vec3 = null!;//主光源节点初始世界坐标\r\n    private _offsetWorPosMainLight: Vec3 = new Vec3();//主光源和玩家的向量差\r\n\r\n    private static _gameSpeed: number = 1;//游戏速度\r\n    private static _isWin: boolean = false;//是否取得胜利\r\n\r\n\r\n    public static set isWin(value: boolean) {\r\n        this._isWin = value;\r\n\r\n        if (GameManager.isGameStart) {\r\n            ClientEvent.dispatchEvent(Constant.EVENT_TYPE.ON_GAME_OVER);\r\n        }\r\n    }\r\n\r\n    public static get isWin() {\r\n        return this._isWin;\r\n    }\r\n    public static set gameSpeed(value: number) {\r\n        console.log(\"gameSpeed\", GameManager.gameSpeed);\r\n\r\n        this._gameSpeed = value;\r\n        GameManager.refreshEffectSpeed(GameManager.ndGameManager, this._gameSpeed);\r\n        GameManager.refreshEffectSpeed(GameManager.ndPlayer as Node, this._gameSpeed);\r\n        GameManager.refreshEffectSpeed(GameManager.ndEffectManager as Node, this._gameSpeed);\r\n    };\r\n\r\n    public static get gameSpeed() {\r\n        return this._gameSpeed;\r\n    }\r\n\r\n    onEnable() {\r\n        // 游戏初始监听\r\n        ClientEvent.on(Constant.EVENT_TYPE.ON_GAME_INIT, this._onGameInit, this);\r\n        ClientEvent.on(Constant.EVENT_TYPE.ON_GAME_OVER, this._onGameOver, this);\r\n        ClientEvent.on(Constant.EVENT_TYPE.ON_GAME_PAUSE, this._onGamePause, this);\r\n        ClientEvent.on(Constant.EVENT_TYPE.REFRESH_LEVEL, this._refreshLevel, this);\r\n        ClientEvent.on(Constant.EVENT_TYPE.RECYCLE_ALL, this._recycleAll, this);\r\n    }\r\n\r\n    onDisable() {\r\n        ClientEvent.off(Constant.EVENT_TYPE.ON_GAME_INIT, this._onGameInit, this);\r\n        ClientEvent.off(Constant.EVENT_TYPE.ON_GAME_OVER, this._onGameOver, this);\r\n        ClientEvent.off(Constant.EVENT_TYPE.ON_GAME_PAUSE, this._onGamePause, this);\r\n        ClientEvent.off(Constant.EVENT_TYPE.REFRESH_LEVEL, this._refreshLevel, this);\r\n        ClientEvent.off(Constant.EVENT_TYPE.RECYCLE_ALL, this._recycleAll, this);\r\n    }\r\n\r\n    start() {\r\n        GameManager.mainCamera = this.camera?.getComponent(CameraComponent) as CameraComponent;\r\n        GameManager.scriptGameCamera = this.camera?.getComponent(GameCamera) as GameCamera;\r\n        GameManager.ndGameManager = this.node;\r\n        GameManager.ndMapManager = find(\"mapManager\") as Node;\r\n        GameManager.ndEffectManager = find(\"effectManager\") as Node;\r\n\r\n        this._oriMainLightWorPos = this.ndLight.worldPosition.clone();\r\n\r\n        if (GameManager.isTesting) {\r\n            //@ts-ignore\r\n            window.uiManager = UIManager.instance;\r\n            //@ts-ignore\r\n            window.AudioManager = AudioManager.instance;\r\n            //@ts-ignore\r\n            window.playerData = PlayerData.instance;\r\n            //@ts-ignore\r\n            window.clientEvent = ClientEvent;\r\n            //@ts-ignore\r\n            window.ndGameManager = GameManager.ndGameManager;\r\n            //@ts-ignore\r\n            window.GameManager = GameManager;\r\n            //@ts-ignore\r\n            window.ndMapManager = GameManager.ndMapManager;\r\n            //@ts-ignore\r\n            window.EffectManager = EffectManager.instance;\r\n            //@ts-ignore\r\n            window.ndEffectManager = GameManager.ndEffectManager;\r\n            //@ts-ignore\r\n            window.constant = Constant;\r\n            //@ts-ignore\r\n            //@ts-ignore\r\n        }\r\n    }\r\n    /**\r\n * 初始化游戏\r\n */\r\n    private _onGameInit() {\r\n        let level = PlayerData.instance.playerInfo.level;\r\n        // “getTableArr”获取表格数组\r\n        let totalLevel = LocalConfig.instance.getTableArr(\"checkpoint\").length;\r\n        //游戏通关后从倒数第10关开始循环(61-70)\r\n        if (level > totalLevel) {\r\n            level = (totalLevel - 10) + (level - totalLevel) % 10;\r\n        }\r\n        // queryByID 通过id获取字典中一条\r\n        this.mapInfo = LocalConfig.instance.queryByID(\"checkpoint\", String(level));\r\n        //设置本层敌人属性加成比例\r\n        GameManager.attackAddition = this.mapInfo.attackAddition;\r\n        GameManager.defenseAddition = this.mapInfo.defenseAddition;\r\n        GameManager.hpAddition = this.mapInfo.hpAddition;\r\n        GameManager.moveSpeedAddition = this.mapInfo.moveSpeedAddition;\r\n        GameManager.attackSpeedAddition = this.mapInfo.attackSpeedAddition;\r\n\r\n        ClientEvent.dispatchEvent(Constant.EVENT_TYPE.HIDE_WARP_GATE);\r\n\r\n        GameManager.isGameStart = false;\r\n        GameManager.isGamePause = false;\r\n        GameManager.isGameOver = false;\r\n        GameManager.isWin = false;\r\n        GameManager.isRevive = false;\r\n        GameManager.arrMonster = [];\r\n        GameManager.gameSpeed = 1;\r\n        GameManager.ndBoss = null!;\r\n        GameManager.existentNum = 0;\r\n\r\n        PlayerData.instance.addFightTimes();\r\n\r\n        AudioManager.instance.pauseAll();\r\n\r\n        // if (GameManager.isFirstLoad) {\r\n        //     this._refreshLevel();\r\n        // } else {\r\n        UIManager.instance.showDialog(\"loading/loadingPanel\", [() => {\r\n            this._refreshLevel();\r\n        }]);\r\n        // }\r\n    }\r\n    /**\r\n* 刷新节点下的动画、粒子播放速度\r\n* @param targetNode\r\n* @param value\r\n* @returns\r\n*/\r\n    public static refreshEffectSpeed(targetNode: Node, value: number) {\r\n        if (!targetNode) {\r\n            return;\r\n        }\r\n        let arrAni = targetNode.getComponentsInChildren(AnimationComponent);\r\n        arrAni.forEach((item: AnimationComponent) => {\r\n            item.clips.forEach((clip: any) => {\r\n                let aniName = clip?.name as string\r\n                let aniState = item.getState(aniName);\r\n                aniState.speed = value;\r\n            })\r\n        })\r\n\r\n        let arrSkeletalAni = targetNode.getComponentsInChildren(SkeletalAnimationComponent);\r\n        arrSkeletalAni.forEach((item: SkeletalAnimationComponent) => {\r\n            item.clips.forEach((clip: any) => {\r\n                let aniName = clip?.name as string\r\n                let aniState = item.getState(aniName);\r\n                aniState.speed = value;\r\n            })\r\n        })\r\n\r\n        let arrParticle = targetNode.getComponentsInChildren(ParticleSystemComponent);\r\n        arrParticle.forEach((item: ParticleSystemComponent) => {\r\n            item.simulationSpeed = value;\r\n        })\r\n    }\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}