{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/framework/uiManager.ts"],"names":["_decorator","find","isValid","Vec3","FightTip","ResourceUtil","PoolManager","tips","GameManager","PlayerBloodBar","MonsterBloodBar","Constant","ccclass","property","SHOW_STR_INTERVAL_TIME","v3_playerBloodOffsetPos","v3_playerBloodScale","v3_monsterBloodOffsetPos","v3_monsterBloodScale","UIManager","_dictSharedPanel","_dictLoading","_arrPopupDialog","_showTipsTime","instance","_instance","isDialogVisible","panelPath","hasOwnProperty","panel","active","parent","showDialog","args","cb","panelPriority","PRIORITY","NORMAL","idxSplit","lastIndexOf","scriptName","slice","script","getComponent","script2","charAt","toUpperCase","show","apply","createUI","err","node","isCloseBeforeShow","console","error","setSiblingIndex","hideDialog","callback","ani","close","pushToPopupSeq","param","popupDialog","isShow","push","_checkPopupSeq","insertToPopupSeq","index","splice","shiftFromPopupSeq","shift","length","first","showTips","content","type","targetPos","scale","str","String","next","_showTipsAni","now","Date","spareTime","setTimeout","getUIPrefabRes","prefab","tipsNode","getNode","tipScript","showPlayerBloodBar","scriptParent","totalBlood","curBlood","offsetPos","ndBloodBar","scriptBloodBar","showMonsterBloodBar","showBloodTips","bloodNum","offset","ndTip","pos","mainCamera","convertToUINode","worldPosition","add","setPosition","scriptTip"],"mappings":"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","sourcesContent":["import { FightTip } from './../ui/common/fightTip';\nimport { _decorator, Node, find, isValid, Vec3 } from \"cc\";\nimport { ResourceUtil } from \"./resourceUtil\";\nimport { PoolManager } from \"./poolManager\";\nimport { tips } from \"../ui/common/tips\";\nimport { GameManager } from '../fight/gameManager';\nimport { PlayerBloodBar } from '../ui/fight/playerBloodBar';\nimport { MonsterBloodBar } from '../ui/fight/monsterBloodBar';\nimport { Constant } from './constant';\nconst { ccclass, property } = _decorator;\n\nlet SHOW_STR_INTERVAL_TIME = 800;\nlet v3_playerBloodOffsetPos = new Vec3(-10, 100, 0);//血条距离玩家节点位置\nlet v3_playerBloodScale= new Vec3(1.5, 1.5, 1.5);//玩家血条缩放大小\nlet v3_monsterBloodOffsetPos = new Vec3(-10, 100, 0);//血条距离小怪节点位置\nlet v3_monsterBloodScale = new Vec3(1.5, 1.5, 1.5);//小怪血条缩放大小\n\n@ccclass(\"UIManager\")\nexport class UIManager {\n    private _dictSharedPanel: any = {}\n    private _dictLoading: any = {}\n    private _arrPopupDialog: any = []\n    private _showTipsTime: number = 0\n\n    private static _instance: UIManager;\n\n    public static get instance () {\n        if (this._instance) {\n            return this._instance;\n        }\n\n        this._instance = new UIManager();\n        return this._instance;\n    }\n\n    /**\n     * 检查当前界面是否正在展示\n     * @param panelPath \n     */\n    public isDialogVisible (panelPath:string) {\n        if (!this._dictSharedPanel.hasOwnProperty(panelPath)) {\n            return false;\n        }\n\n        let panel = this._dictSharedPanel[panelPath];\n\n        return isValid(panel) && panel.active && isValid(panel.parent);\n    }\n\n\n    /**\n     * 显示单例界面\n     * @param {String} panelPath \n     * @param {Array} args \n     * @param {Function} cb 回调函数，创建完毕后回调\n     */\n    public showDialog(panelPath:string, args?: any, cb?: Function, panelPriority: number = Constant.PRIORITY.NORMAL) {\n        if (this._dictLoading[panelPath]) {\n            return;\n        }\n\n        let idxSplit = panelPath.lastIndexOf('/');\n        let scriptName = panelPath.slice(idxSplit + 1);\n        \n        if (!args) {\n            args = [];\n        }\n\n        if (this._dictSharedPanel.hasOwnProperty(panelPath)) {\n            let panel = this._dictSharedPanel[panelPath];\n            if (isValid(panel)) {\n                panel.parent = find(\"Canvas\");\n                panel.active = true;\n                let script = panel.getComponent(scriptName);\n                let script2 = panel.getComponent(scriptName.charAt(0).toUpperCase() + scriptName.slice(1));\n\n                if (script && script.show) {\n                    script.show.apply(script, args);\n                    cb && cb(script);   \n                } else if (script2 && script2.show){\n                    script2.show.apply(script2, args);               \n                    cb && cb(script2);\n                } else {\n                    throw `查找不到脚本文件${scriptName}`;\n                }\n\n                return;\n            }\n        }\n\n        this._dictLoading[panelPath] = true;\n        ResourceUtil.createUI(panelPath, (err: any, node: Node) => {\n            //判断是否有可能在显示前已经被关掉了？\n            let isCloseBeforeShow = false;\n            if (!this._dictLoading[panelPath]) {\n                //已经被关掉\n                isCloseBeforeShow = true;\n            }\n\n            this._dictLoading[panelPath] = false;\n            if (err) {\n                console.error(err);\n                return;\n            }\n\n            // node.getComponent(UITransformComponent).priority = panelPriority;\n            node.setSiblingIndex(panelPriority);\n\n            this._dictSharedPanel[panelPath] = node;\n\n            let script: any = node.getComponent(scriptName);\n            let script2: any = node.getComponent(scriptName.charAt(0).toUpperCase() + scriptName.slice(1));\n            if (script && script.show) {\n                script.show.apply(script, args);\n                cb && cb(script);   \n            } else if (script2 && script2.show){\n                script2.show.apply(script2, args);               \n                cb && cb(script2);\n            } else {\n                throw `查找不到脚本文件${scriptName}`;\n            }\n\n            if (isCloseBeforeShow) {\n                //如果在显示前又被关闭，则直接触发关闭掉\n                this.hideDialog(panelPath);\n            }\n        });\n    }\n\n    /**\n     * 隐藏单例界面\n     * @param {String} panelPath \n     * @param {fn} callback\n     */\n    public hideDialog(panelPath: string, callback?: Function) {\n        if (this._dictSharedPanel.hasOwnProperty(panelPath)) {\n            let panel = this._dictSharedPanel[panelPath];\n            if (panel && isValid(panel)) {\n                let ani = panel.getComponent('animationUI');\n                if (ani) {\n                    ani.close(() => {\n                        panel.parent = null;\n                        if (callback && typeof callback === 'function') {\n                            callback();\n                        }\n                    });\n                } else {\n                    panel.parent = null;\n                    if (callback && typeof callback === 'function') {\n                        callback();\n                    }\n                }\n            } else if (callback && typeof callback === 'function') {\n                callback();\n            }\n        }\n\n        this._dictLoading[panelPath] = false;\n    }\n\n    /**\n     * 将弹窗加入弹出窗队列\n     * @param {string} panelPath \n     * @param {string} scriptName \n     * @param {*} param \n     */\n    public pushToPopupSeq(panelPath: string, scriptName: string, param: any) {\n        let popupDialog = {\n            panelPath: panelPath,\n            scriptName: scriptName,\n            param: param,\n            isShow: false\n        };\n\n        this._arrPopupDialog.push(popupDialog);\n\n        this._checkPopupSeq();\n    }\n\n    /**\n     * 将弹窗加入弹出窗队列\n     * @param {number} index \n     * @param {string} panelPath \n     * @param {string} scriptName \n     * @param {*} param \n     */\n    public insertToPopupSeq(index: number, panelPath: string, param: any) {\n        let popupDialog = {\n            panelPath: panelPath,\n            param: param,\n            isShow: false\n        };\n\n        this._arrPopupDialog.splice(index, 0, popupDialog);\n        //this._checkPopupSeq();\n    }\n\n    /**\n     * 将弹窗从弹出窗队列中移除\n     * @param {string} panelPath \n     */\n    public shiftFromPopupSeq(panelPath: string) {\n        this.hideDialog(panelPath, () => {\n            if (this._arrPopupDialog[0] && this._arrPopupDialog[0].panelPath === panelPath) {\n                this._arrPopupDialog.shift();\n                this._checkPopupSeq();\n            }\n        })\n    }\n\n    /**\n     * 检查当前是否需要弹窗\n     */\n    private _checkPopupSeq() {\n        if (this._arrPopupDialog.length > 0) {\n            let first = this._arrPopupDialog[0];\n\n            if (!first.isShow) {\n                this.showDialog(first.panelPath, first.param);\n                this._arrPopupDialog[0].isShow = true;\n            }\n        }\n    }\n\n    /**\n     * 显示提示\n     * @param {String} content \n     * @param {Function} cb \n     */\n    public showTips (content: string | number, type: string = 'txt', targetPos: Vec3 = new Vec3(),  scale: number = 1, callback: Function = ()=>{}) {\n        let str = String(content);\n        let next = ()=>{\n            this._showTipsAni(str, type, targetPos, scale, callback);\n        }\n\n        var now = Date.now();\n        if (now - this._showTipsTime < SHOW_STR_INTERVAL_TIME && type !== 'gold' && type !== 'heart') {\n            var spareTime = SHOW_STR_INTERVAL_TIME - (now - this._showTipsTime);\n            setTimeout(() =>{\n                next();\n            }, spareTime);\n\n            this._showTipsTime = now + spareTime;\n        } else {\n            next();\n            this._showTipsTime = now;\n        }\n    }\n \n    /**\n     * 内部函数\n     * @param {String} content \n     * @param {Function} cb \n     */\n    private _showTipsAni (content: string, type: string, targetPos: Vec3, scale: number, callback?: Function) {\n        ResourceUtil.getUIPrefabRes('common/tips', function (err: any, prefab: any) {\n            if (err) {\n                return;\n            }\n\n            let tipsNode = PoolManager.instance.getNode(prefab, find(\"Canvas\") as Node);\n\n            let tipScript = tipsNode.getComponent(tips) as tips;\n            tipScript.show(content, type, targetPos, scale, callback);\n        });\n    }\n\n    /**\n     * 展示玩家血条\n     *\n     * @param {*} scriptParent 条使用者绑定的节点，如玩家或者小怪\n     * @param {number} totalBlood 总血量\n     * @param {number} curBlood 当前血量\n     * @param {Function} [callback=()=>{}]\n     * @param {Vec3} [offsetPos=v3_playerBloodOffsetPos] 血条位置偏差\n     * @param {Vec3} [scale=v3_playerBloodScale] 血条缩放大小\n     * @memberof UIManager\n     */\n    public showPlayerBloodBar (scriptParent: any, totalBlood: number, curBlood: number, callback: Function = ()=>{}, offsetPos: Vec3 = v3_playerBloodOffsetPos, scale: Vec3 = v3_playerBloodScale) {\n        ResourceUtil.getUIPrefabRes('fight/playerBloodBar', function (err: any, prefab: any) {\n            if (err) {\n                return;\n            }\n\n            let ndBloodBar = PoolManager.instance.getNode(prefab, find(\"Canvas\") as Node) as Node;\n            ndBloodBar.setSiblingIndex(0);\n            let scriptBloodBar = ndBloodBar.getComponent(PlayerBloodBar) as PlayerBloodBar;\n            scriptParent.scriptBloodBar = scriptBloodBar;\n            scriptBloodBar.show(scriptParent, totalBlood, curBlood, offsetPos, scale, callback);\n        });\n    }\n\n    /**\n     * 展示小怪血条\n     *  \n     * @param {*} scriptParent \n     * @param {number} totalBlood\n     * @param {number} bloodBarType\n     * @param {Function} [callback=()=>{}]\n     * @param {Vec3} [offsetPos=MONSTER_BLOOD_OFFSET_POS]\n     * @param {Vec3} [scale=MONSTER_BLOOD_SCALE]\n     * @memberof uiManager\n     */\n    public showMonsterBloodBar (scriptParent: any, totalBlood: number, callback: Function = ()=>{}, offsetPos: Vec3 = v3_monsterBloodOffsetPos, scale: Vec3 = v3_monsterBloodScale) {\n        ResourceUtil.getUIPrefabRes('fight/monsterBloodBar', function (err: any, prefab: any) {\n            if (err) {\n                return;\n            }\n\n            let ndBloodBar = PoolManager.instance.getNode(prefab, find(\"Canvas\") as Node);\n            let scriptBloodBar = ndBloodBar.getComponent(MonsterBloodBar) as MonsterBloodBar;\n            scriptParent.scriptBloodBar = scriptBloodBar;\n            scriptBloodBar.show(scriptParent, totalBlood, offsetPos, scale, callback);\n        });\n    }\n\n    /**\n     * 展示血量提示\n     */\n    public showBloodTips (scriptParent: any, type: number, bloodNum: number, offset: Vec3, callback?: Function) {\n        ResourceUtil.getUIPrefabRes('common/fightTip',  (err: any, prefab: any)=> {\n            if (err) {\n                return;\n            }\n\n            let ndTip = <Node>PoolManager.instance.getNode(prefab,  <Node>find(\"Canvas\"));\n            let pos = GameManager.mainCamera?.convertToUINode(scriptParent.node.worldPosition, find('Canvas') as Node) as Vec3;\n            pos.add(offset);\n            ndTip.setPosition(pos);\n            \n            let scriptTip = ndTip.getComponent(FightTip) as FightTip;\n            scriptTip.show(scriptParent, type, bloodNum, callback);\n        });\n    }\n}\n"]}