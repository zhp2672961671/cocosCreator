{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/ui/revive/revivePanel.ts"],"names":["_decorator","Component","Node","SpriteComponent","LabelComponent","UITransformComponent","PlayerData","ClientEvent","Constant","UIManager","AudioManager","ccclass","property","RevivePanel","_countDown","_maxMaskHeight","_curMaskHeight","_callback","countDown","value","lbCountDown","string","String","Math","floor","lbLevel","instance","playerInfo","level","ndMask","getComponent","setContentSize","_close","start","show","callback","onBtnSkipClick","playSound","SOUND","CLICK","onBtnReviveClick","hideDialog","dispatchEvent","EVENT_TYPE","ON_REVIVE","showDialog","update","deltaTime"],"mappings":"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","sourcesContent":["import { PlayerData } from './../../framework/playerData';\nimport { _decorator, Component, Node, Sprite, SpriteComponent, LabelComponent, UITransformComponent } from 'cc';\nimport { ClientEvent } from '../../framework/clientEvent';\nimport { Constant } from '../../framework/constant';\nimport { UIManager } from '../../framework/uiManager';\nimport { AudioManager } from '../../framework/audioManager';\nconst { ccclass, property } = _decorator;\n//复活界面脚本\n@ccclass('RevivePanel')\nexport class RevivePanel extends Component {\n    @property(SpriteComponent)\n    public spPayIcon: SpriteComponent = null!;\n\n    @property(LabelComponent)\n    public lbLevel: LabelComponent = null!;\n\n    @property(Node)\n    public ndMask: Node = null!;\n\n    @property(LabelComponent)\n    public lbCountDown: LabelComponent = null!;\n\n    public set countDown (value: number) {\n        this._countDown = value;\n        this.lbCountDown.string = String(Math.floor(this._countDown));\n        this.lbLevel.string = PlayerData.instance.playerInfo.level;\n\n        this._curMaskHeight += this._maxMaskHeight / (this._countDown * 120);\n        this._curMaskHeight = this._curMaskHeight >= this._maxMaskHeight ? this._maxMaskHeight : this._curMaskHeight;\n        this.ndMask.getComponent(UITransformComponent)?.setContentSize(260, this._curMaskHeight);\n\n        if (value < 0) {\n           this._close();\n        }\n    } \n\n    public get countDown () {\n        return this._countDown;\n    }\n\n    private _countDown: number = 10;\n    private _maxMaskHeight: number = 190;\n    private _curMaskHeight: number = 0;\n    private _callback: Function = null!;\n\n    start () {\n        // [3]\n    }\n\n    public show (callback: Function) {\n        this._countDown = 10;\n        this._curMaskHeight = 0;\n        this._callback = callback;\n    }\n\n    public onBtnSkipClick () {\n        AudioManager.instance.playSound(Constant.SOUND.CLICK);\n\n        this._close()\n    }\n\n    public onBtnReviveClick () {\n        AudioManager.instance.playSound(Constant.SOUND.CLICK);\n        UIManager.instance.hideDialog(\"revive/revivePanel\");\n        ClientEvent.dispatchEvent(Constant.EVENT_TYPE.ON_REVIVE);\n    }\n\n    private _close () {\n        this._callback && this._callback();\n        UIManager.instance.hideDialog(\"fight/fightPanel\");\n        UIManager.instance.hideDialog(\"revive/revivePanel\");\n        UIManager.instance.showDialog(\"settlement/settlementPanel\");\n    }\n\n    update (deltaTime: number) {\n        if (this.countDown > 0) {\n            this.countDown -= deltaTime;\n        }\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n"]}