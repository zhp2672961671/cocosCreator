{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/ui/shopPanel/shopPanel.ts"],"names":["_decorator","Component","Node","SpriteComponent","ShopItem","Util","UIManager","Constant","PlayerData","LocalConfig","AudioManager","ccclass","property","ShopPanel","_callback","start","show","callback","arrLock","instance","getLockPlyerSkill","shuffle","ndSkills","children","forEach","ndChild","idx","arr","info","queryByID","ID","active","scriptItem","getComponent","init","_close","onBtnGiveUpClick","playSound","SOUND","CLICK","onBtnRefreshClick","hideDialog","showDialog","onBtnCloseClick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,e,OAAAA,e;;AAL7BC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,U,iBAAAA,U;;AAEAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBZ,U,GAC9B;;2BAEaa,S,WADZF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACV,IAAD,C,UAGRU,QAAQ,CAACT,eAAD,C,2BALb,MACaU,SADb,SAC+BZ,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAO7Ba,SAP6B,GAOP,IAPO;AAAA;;AASrCC,QAAAA,KAAK,GAAI,CACL;AACH;;AAEMC,QAAAA,IAAI,CAAEC,QAAF,EAAuB;AAC9B,eAAKH,SAAL,GAAiBG,QAAjB;AAEA,cAAIC,OAAY,GAAG;AAAA;AAAA,wCAAWC,QAAX,CAAoBC,iBAApB,EAAnB;AACAF,UAAAA,OAAO,GAAG;AAAA;AAAA,4BAAKG,OAAL,CAAaH,OAAb,CAAV;AAEA,eAAKI,QAAL,CAAcC,QAAd,CAAuBC,OAAvB,CAA+B,CAACC,OAAD,EAAgBC,GAAhB,EAA6BC,GAA7B,KAAwC;AACnE,gBAAIT,OAAO,CAACQ,GAAD,CAAX,EAAkB;AACd,kBAAIE,IAAS,GAAG;AAAA;AAAA,8CAAYT,QAAZ,CAAqBU,SAArB,CAA+B,aAA/B,EAA8CX,OAAO,CAACQ,GAAD,CAAP,CAAaI,EAA3D,CAAhB;AACAL,cAAAA,OAAO,CAACM,MAAR,GAAiB,IAAjB;AACA,kBAAIC,UAAU,GAAGP,OAAO,CAACQ,YAAR;AAAA;AAAA,uCAAjB;AACAD,cAAAA,UAAU,CAACE,IAAX,CAAgBN,IAAhB,EAAsB,MAAI;AACtB,qBAAKO,MAAL;AACH,eAFD;AAGH,aAPD,MAOO;AACHV,cAAAA,OAAO,CAACM,MAAR,GAAiB,KAAjB;AACH;AACJ,WAXD;AAYH;;AAEMK,QAAAA,gBAAgB,GAAI;AACvB;AAAA;AAAA,4CAAajB,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;;AAEA,eAAKJ,MAAL;AACH;;AAEMK,QAAAA,iBAAiB,GAAI;AACxB;AAAA;AAAA,4CAAarB,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;AACA,eAAKvB,IAAL,CAAU,KAAKF,SAAf;AACH;;AAEOqB,QAAAA,MAAM,GAAI;AACd,eAAKrB,SAAL,IAAkB,KAAKA,SAAL,EAAlB;AACA;AAAA;AAAA,sCAAUK,QAAV,CAAmBsB,UAAnB,CAA8B,gBAA9B;AACA;AAAA;AAAA,sCAAUtB,QAAV,CAAmBuB,UAAnB,CAA8B,kBAA9B;AACH;;AAEMC,QAAAA,eAAe,GAAI;AACtB;AAAA;AAAA,4CAAaxB,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;;AAEA,eAAKJ,MAAL;AACH,SAtDoC,CAwDrC;AACA;AACA;;;AA1DqC,O;;;;;iBAEb,I;;;;;;;iBAGgB,I","sourcesContent":["import { ShopItem } from './shopItem';\nimport { Util } from './../../framework/util';\nimport { UIManager } from './../../framework/uiManager';\nimport { Constant } from './../../framework/constant';\nimport { PlayerData } from './../../framework/playerData';\nimport { _decorator, Component, Node, SpriteComponent, LabelComponent } from 'cc';\nimport { LocalConfig } from '../../framework/localConfig';\nimport { AudioManager } from '../../framework/audioManager';\n\nconst { ccclass, property } = _decorator;\n//商店脚本\n@ccclass('ShopPanel')\nexport class ShopPanel extends Component {\n    @property(Node)\n    public ndSkills: Node = null!;\n\n    @property(SpriteComponent)\n    public spRefreshIcon: SpriteComponent = null!;\n\n    private _callback: Function = null!;\n\n    start () {\n        // [3]\n    }\n\n    public show (callback?: Function) {\n        this._callback = callback!;\n\n        let arrLock: any = PlayerData.instance.getLockPlyerSkill();\n        arrLock = Util.shuffle(arrLock);\n        \n        this.ndSkills.children.forEach((ndChild: Node, idx: number, arr: any)=>{\n            if (arrLock[idx]) {\n                let info: any = LocalConfig.instance.queryByID(\"playerSkill\", arrLock[idx].ID);\n                ndChild.active = true;\n                let scriptItem = ndChild.getComponent(ShopItem) as ShopItem;\n                scriptItem.init(info, ()=>{\n                    this._close();\n                });\n            } else {\n                ndChild.active = false;\n            }\n        })\n    }\n\n    public onBtnGiveUpClick () {\n        AudioManager.instance.playSound(Constant.SOUND.CLICK);\n\n        this._close();\n    }\n\n    public onBtnRefreshClick () {\n        AudioManager.instance.playSound(Constant.SOUND.CLICK);\n        this.show(this._callback);\n    }\n\n    private _close () {\n        this._callback && this._callback();\n        UIManager.instance.hideDialog(\"shop/shopPanel\");\n        UIManager.instance.showDialog(\"fight/fightPanel\");\n    }\n\n    public onBtnCloseClick () {\n        AudioManager.instance.playSound(Constant.SOUND.CLICK);\n\n        this._close();\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n"]}