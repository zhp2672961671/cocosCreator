{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/fight/monsterSkill/energyBall.ts"],"names":["_decorator","Component","Node","Vec3","Util","GameManager","EffectManager","AudioManager","Constant","PoolManager","ccclass","property","EnergyBall","baseInfo","skillInfo","_curSpeed","_targetSpeed","_offsetPos","_curWorPos","_disappearRange","_targetWorPos","start","init","scriptParent","scriptWarning","hideWarning","flySpeed","instance","playParticle","node","playSound","SOUND","ENERGY_BALL","update","deltaTime","parent","ndPlayer","isGameOver","isGamePause","lerp","set","translate","NodeSpace","LOCAL","worldPosition","subtract","length","putNode"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAESA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAF7BC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,W,iBAAAA,W;;AAEAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,W,iBAAAA,W;;;;;;;;;AACT;OACM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBX,U;;4BAGjBY,U,WADZF,OAAO,CAAC,YAAD,C,gBAAR,MACaE,UADb,SACgCX,SADhC,CAC0C;AAAA;AAAA;AAAA,eAC/BY,QAD+B,GACf,IADe;AAAA,eAE/BC,SAF+B,GAEd,IAFc;AAAA,eAI9BC,SAJ8B,GAIV,CAJU;AAAA,eAK9BC,YAL8B,GAKP,CALO;AAAA,eAM9BC,UAN8B,GAMX,IAAId,IAAJ,EANW;AAAA,eAO9Be,UAP8B,GAOX,IAAIf,IAAJ,EAPW;AAAA,eAQ9BgB,eAR8B,GAQJ,EARI;AAAA,eAS9BC,aAT8B,GASR,IAAIjB,IAAJ,EATQ;AAAA;;AASG;AAEzCkB,QAAAA,KAAK,GAAI,CACL;AACH;AAED;AACJ;AACA;;;AACWC,QAAAA,IAAI,CAAER,SAAF,EAAkBD,QAAlB,EAAiCU,YAAjC,EAAoD;AAAA;;AAC3D,eAAKT,SAAL,GAAiBA,SAAjB;AACA,eAAKD,QAAL,GAAgBA,QAAhB;AACA,mCAAAU,YAAY,CAACC,aAAb,2CAA4BC,WAA5B;AACA,eAAKT,YAAL,GAAoBF,SAAS,CAACY,QAA9B;AAAuC;AACvC,eAAKX,SAAL,GAAiBD,SAAS,CAACY,QAAV,GAAqB,GAAtC;AAEA;AAAA;AAAA,8CAAcC,QAAd,CAAuBC,YAAvB,CAAoC,KAAKC,IAAzC;AAEA;AAAA;AAAA,4CAAaF,QAAb,CAAsBG,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,WAA/C;AACH;;AAEDC,QAAAA,MAAM,CAAEC,SAAF,EAAqB;AACvB,cAAI,CAAC,KAAKL,IAAL,CAAUM,MAAX,IAAqB,CAAC;AAAA;AAAA,0CAAYC,QAAlC,IAA8C;AAAA;AAAA,0CAAYC,UAA1D,IAAwE;AAAA;AAAA,0CAAYC,WAAxF,EAAqG;AACjG;AACH,WAHsB,CAKvB;;;AACA,eAAKvB,SAAL,GAAiB;AAAA;AAAA,4BAAKwB,IAAL,CAAU,KAAKvB,YAAf,EAA6B,KAAKD,SAAlC,EAA6C,IAA7C,CAAjB;;AACA,eAAKK,aAAL,CAAmBoB,GAAnB,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAACN,SAAD,GAAa,KAAKnB,SAA/C;;AACA,eAAKc,IAAL,CAAUY,SAAV,CAAoB,KAAKrB,aAAzB,EAAwClB,IAAI,CAACwC,SAAL,CAAeC,KAAvD;;AACA,eAAKzB,UAAL,CAAgBsB,GAAhB,CAAoB,KAAKX,IAAL,CAAUe,aAA9B,EATuB,CAWvB;;;AACAzC,UAAAA,IAAI,CAAC0C,QAAL,CAAc,KAAK5B,UAAnB,EAA+B,KAAKC,UAApC,EAAgD;AAAA;AAAA,0CAAYkB,QAAZ,CAAqBQ,aAArE;;AACA,cAAI,KAAK3B,UAAL,IAAmB,KAAKA,UAAL,CAAgB6B,MAAhB,MAA4B,KAAK3B,eAAxD,EAAyE;AACrE;AAAA;AAAA,4CAAYQ,QAAZ,CAAqBoB,OAArB,CAA6B,KAAKlB,IAAlC;AACH;AACJ;;AA9CqC,O","sourcesContent":["import { Util } from './../../framework/util';\nimport { GameManager } from './../gameManager';\nimport { _decorator, Component, Node, Vec3 } from 'cc';\nimport { EffectManager } from '../../framework/effectManager';\nimport { AudioManager } from '../../framework/audioManager';\nimport { Constant } from '../../framework/constant';\nimport { PoolManager } from '../../framework/poolManager';\n//能量球脚本: 直线飞行\nconst { ccclass, property } = _decorator;\n\n@ccclass('EnergyBall')\nexport class EnergyBall extends Component {\n    public baseInfo: any = null!;//敌人基本信息\n    public skillInfo: any = null!;//技能信息\n\n    private _curSpeed: number = 0;//当前速度\n    private _targetSpeed: number = 0;//目标速度\n    private _offsetPos: Vec3 = new Vec3();//和玩家之间的向量差\n    private _curWorPos: Vec3 = new Vec3();//当前节点世界坐标\n    private _disappearRange: number = 25;//能量球节点超过玩家这个范围则隐藏\n    private _targetWorPos: Vec3 = new Vec3();//能量球的下次目标位置\n\n    start () {\n        // [3]\n    }\n\n    /**\n    * 初始化 \n    */\n    public init (skillInfo: any, baseInfo: any, scriptParent: any) {\n        this.skillInfo = skillInfo;\n        this.baseInfo = baseInfo;\n        scriptParent.scriptWarning?.hideWarning();\n        this._targetSpeed = skillInfo.flySpeed;;\n        this._curSpeed = skillInfo.flySpeed * 0.5;\n\n        EffectManager.instance.playParticle(this.node);\n\n        AudioManager.instance.playSound(Constant.SOUND.ENERGY_BALL);  \n    }\n\n    update (deltaTime: number) {\n        if (!this.node.parent || !GameManager.ndPlayer || GameManager.isGameOver || GameManager.isGamePause) {\n            return;\n        }\n\n        //朝forward方向飞行\n        this._curSpeed = Util.lerp(this._targetSpeed, this._curSpeed, 0.25);\n        this._targetWorPos.set(0, 0, -deltaTime * this._curSpeed);\n        this.node.translate(this._targetWorPos, Node.NodeSpace.LOCAL);\n        this._curWorPos.set(this.node.worldPosition);\n\n        //超过玩家一定范围则隐藏\n        Vec3.subtract(this._offsetPos, this._curWorPos, GameManager.ndPlayer.worldPosition);\n        if (this._offsetPos && this._offsetPos.length() >= this._disappearRange) {\n            PoolManager.instance.putNode(this.node);\n        }\n    }\n}"]}