{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/ui/loading/loadingPanel.ts"],"names":["_decorator","Component","AnimationComponent","Constant","UIManager","ClientEvent","GameManager","ccclass","property","LoadingPanel","_isShowOver","_isNeedHide","_showCb","_hideCb","onEnable","on","EVENT_TYPE","HIDE_LOADING_PANEL","_hideLoadingPanel","onDisable","off","start","show","callback","_showLoadingPanel","scriptGameCamera","resetCamera","aniCloud","getState","time","sample","play","once","EventType","FINISHED","instance","hideDialog","showDialog"],"mappings":"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","sourcesContent":["import { Constant } from './../../framework/constant';\nimport { UIManager } from './../../framework/uiManager';\nimport { _decorator, Component, AnimationComponent } from 'cc';\nimport { ClientEvent } from '../../framework/clientEvent';\nimport { GameManager } from '../../fight/gameManager';\nconst { ccclass, property } = _decorator;\n//加载界面脚本\n@ccclass('LoadingPanel')\nexport class LoadingPanel extends Component {\n    @property(AnimationComponent)\n    public aniCloud: AnimationComponent = null!;\n\n    private _isShowOver: boolean = false;\n    private _isNeedHide: boolean = false;\n    private _showCb: Function =  null!;\n    private _hideCb: Function =  null!;\n\n    onEnable () {\n        ClientEvent.on(Constant.EVENT_TYPE.HIDE_LOADING_PANEL, this._hideLoadingPanel, this);\n    }\n\n    onDisable () {\n        ClientEvent.off(Constant.EVENT_TYPE.HIDE_LOADING_PANEL, this._hideLoadingPanel, this);\n    }\n\n    start () {\n        // [3]\n    }\n\n    public show (callback: Function) {\n        this._isShowOver = false;\n        this._isNeedHide = false;\n        this._hideCb = null!;\n        this._showCb = callback;\n\n        this._showLoadingPanel();\n    }\n\n    private _hideLoadingPanel (callback?: Function) {\n        this._hideCb = callback!;\n        this._isNeedHide = true;\n        if (this._isShowOver) {\n            GameManager.scriptGameCamera.resetCamera();   \n\n            this._hideCb && this._hideCb();\n            this.aniCloud.getState(\"cloudAnimationOut\").time = 0;\n            this.aniCloud.getState(\"cloudAnimationOut\").sample();\n            this.aniCloud.play(\"cloudAnimationOut\");\n            this.aniCloud.once(AnimationComponent.EventType.FINISHED, ()=>{\n                UIManager.instance.hideDialog(\"loading/loadingPanel\");\n                UIManager.instance.showDialog(\"fight/fightPanel\", [this]);\n            });\n        }\n    }\n\n    private _showLoadingPanel () {\n        this.aniCloud.getState(\"cloudAnimationIn\").time = 0;\n        this.aniCloud.getState(\"cloudAnimationIn\").sample();\n        this.aniCloud.play(\"cloudAnimationIn\");\n        this.aniCloud.once(AnimationComponent.EventType.FINISHED, ()=>{\n            this._showCb && this._showCb();\n\n            this._isShowOver = true;\n            if (this._isNeedHide) {\n                this._hideLoadingPanel(this._hideCb);\n            }\n        });\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}"]}