{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/ui/shopPanel/shopItem.ts"],"names":["_decorator","Component","SpriteComponent","LabelComponent","Color","ButtonComponent","EffectManager","GameManager","PlayerData","ResourceUtil","AudioManager","Constant","ccclass","property","ShopItem","_callback","_itemInfo","_colorRed","_colorBlack","_isMoneyEnough","start","init","itemInfo","callback","lbName","string","name","lbDesc","desc","lbGold","price","instance","playerInfo","gold","btnCom","interactable","color","setSpriteFrame","icon","spSkillIcon","err","onBtnItemClick","playSound","SOUND","SELL","addPlayerSkill","addGold","loadAndPlayEffect","ndPlayer","gameSpeed"],"mappings":"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","sourcesContent":["import { EffectManager } from './../../framework/effectManager';\nimport { GameManager } from './../../fight/gameManager';\nimport { _decorator, Component, SpriteComponent, LabelComponent, Color, ButtonComponent } from 'cc';\nimport { PlayerData } from '../../framework/playerData';\nimport { ResourceUtil } from '../../framework/resourceUtil';\nimport { AudioManager } from '../../framework/audioManager';\nimport { Constant } from '../../framework/constant';\nconst { ccclass, property } = _decorator;\n//商品脚本\n@ccclass('ShopItem')\nexport class ShopItem extends Component {\n    @property(SpriteComponent)\n    public spSkillIcon: SpriteComponent = null!;\n    \n    @property(LabelComponent)\n    public lbName: LabelComponent = null!;\n\n    @property(LabelComponent)\n    public lbDesc: LabelComponent = null!;\n\n    @property(LabelComponent)\n    public lbGold: LabelComponent = null!;\n\n    @property(ButtonComponent)\n    public btnCom: ButtonComponent = null!;\n\n    private _callback: Function = null!;\n    private _itemInfo: any = null!;\n    private _colorRed: Color = new Color(255, 0, 0, 255);\n    private _colorBlack: Color = new Color(0, 0, 0, 255);\n    private _isMoneyEnough: boolean = false;//是否有足够的钱购买技能 \n\n    start () {\n        // [3]\n    }\n\n    public init (itemInfo: any, callback: Function) {\n        this._itemInfo = itemInfo;\n        this._callback = callback;\n\n        this.lbName.string = itemInfo.name;\n        this.lbDesc.string = itemInfo.desc;\n        this.lbGold.string = itemInfo.price;\n        \n        this._isMoneyEnough = PlayerData.instance.playerInfo.gold >= itemInfo.price;\n        this.btnCom.interactable = this._isMoneyEnough;\n\n        if (!this._isMoneyEnough) {\n            this.lbGold.color = this._colorRed; \n        } else {\n            this.lbGold.color = this._colorBlack;\n        }\n\n        ResourceUtil.setSpriteFrame(`texture/skillIcon/${itemInfo.icon}`, this.spSkillIcon, (err: any)=>{});\n    }\n\n    public onBtnItemClick () {\n        AudioManager.instance.playSound(Constant.SOUND.SELL);\n\n        if (this._isMoneyEnough) {\n            this._callback && this._callback();\n            PlayerData.instance.addPlayerSkill(this._itemInfo);\n            GameManager.addGold(-this._itemInfo.price);\n\n            EffectManager.instance.loadAndPlayEffect(true, GameManager.ndPlayer, \"levelUp/levelUp\", 1, null, null, false, true, GameManager.gameSpeed, true);\n        }\n    }\n}\n"]}