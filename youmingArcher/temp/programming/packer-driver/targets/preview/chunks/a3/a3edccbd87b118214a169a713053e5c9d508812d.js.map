{"version":3,"sources":["file:///E:/myCocosGame/youmingArcher/assets/script/ui/common/tips.ts"],"names":["_decorator","Component","LabelComponent","Vec3","tween","UIOpacityComponent","isValid","SpriteFrame","SpriteComponent","UITransformComponent","Color","Util","PoolManager","ccclass","property","tips","_movePos","_curTipPos","_uiTipTargetPos","start","show","content","type","targetPos","scale","callback","node","setScale","size","lbTips","getComponent","contentSize","instance","putNode","string","color","spBg","enabled","set","UIOpacityBg","opacity","spIcon","spriteFrame","sfGold","sfHeart","formatValue","Number","to","easing","call","setPosition","active","scheduleOnce","position"],"mappings":"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","sourcesContent":["import { Util } from './../../framework/util';\nimport { _decorator, Component, LabelComponent, Vec3, tween, UIOpacityComponent, isValid, SpriteFrame, SpriteComponent, UITransformComponent, Color } from 'cc';\nimport { PoolManager } from '../../framework/poolManager';\nconst { ccclass, property } = _decorator;\n//提示脚本\n@ccclass('tips')\nexport class tips extends Component {\n    @property(LabelComponent)\n    public lbTips: LabelComponent = null!;\n\n    @property(SpriteComponent)\n    public spIcon: SpriteComponent = null!;\n\n    @property(SpriteComponent)\n    public spBg: SpriteComponent = null!;\n\n    @property(UIOpacityComponent)\n    public UIOpacityBg: UIOpacityComponent = null!;\n\n    @property(SpriteFrame)\n    public sfGold: SpriteFrame = null!;\n\n    @property(SpriteFrame)\n    public sfHeart: SpriteFrame = null!;\n\n    private _movePos: Vec3 = new Vec3();\n    private _curTipPos = new Vec3();\n    private _uiTipTargetPos: Vec3 = new Vec3(0, 230, 0);//文字提示目标位置\n\n    start () {\n\n    }\n\n    public show (content: string, type: string, targetPos: Vec3, scale: number, callback: Function = ()=>{}) {\n        this.node.setScale(scale, scale, scale);\n\n        let size = this.lbTips?.node?.getComponent(UITransformComponent)?.contentSize;\n        if (!isValid(size)) {//size不存在，自我销毁\n            PoolManager.instance.putNode(this.node);\n            return;\n        }\n\n        this.lbTips.string = content;\n        this.lbTips.color = new Color(214, 132, 53, 255);\n\n        if (type === 'gold' || type === 'heart') {\n            this.spBg.enabled = false;\n            this._movePos.set(0, 0, 0);\n            this._curTipPos.set(0, 0, 0);\n            this.UIOpacityBg.opacity = 50;\n\n            if (type === 'gold') {\n                this.spIcon.spriteFrame = this.sfGold;\n            } else if (type === 'heart') {\n                this.spIcon.spriteFrame = this.sfHeart;\n            }\n\n            this.lbTips.color = new Color(255,255,255,255);\n            this.lbTips.string = Util.formatValue(Number(content));\n\n            tween(this.node)\n            .to(1.2, { scale: new Vec3(scale, scale, scale) }, { easing: 'smooth' })\n            .start();\n\n            tween(this.UIOpacityBg)\n            .to(0.8, { opacity: 255} , { easing: 'smooth' })\n            .to(0.4, { opacity: 0} , { easing: 'smooth' })\n            .call(()=>{\n                callback && callback();\n                PoolManager.instance.putNode(this.node);\n            })\n            .start();\n        } else {\n            //纯文字提示\n            this.spBg.enabled = true;\n            this.UIOpacityBg.opacity = 255;\n            this.node.setPosition(targetPos);\n\n            this.spIcon.node.active = false;\n\n            this.scheduleOnce(()=>{\n                tween(this.node)\n                .to(1.1, { position: this._uiTipTargetPos}, { easing: 'smooth' })\n                .call(()=>{\n                    callback && callback();\n                    PoolManager.instance.putNode(this.node);\n                })\n                .start();\n\n                tween(this.UIOpacityBg)\n                .to(0.7, { opacity: 220} , { easing: 'smooth' })\n                .to(0.4, { opacity: 0} , { easing: 'smooth' })\n                .call(()=>{\n                \n                })\n                .start();\n            }, 0.8);\n        }\n    }\n}\n"]}