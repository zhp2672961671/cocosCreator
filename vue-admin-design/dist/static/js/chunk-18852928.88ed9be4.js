(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18852928"],{"0194":function(t,e,a){"use strict";a("3b9a")},1:function(t,e){},2:function(t,e){},3:function(t,e){},3890:function(t,e,a){"use strict";a("42aa")},"3b9a":function(t,e,a){},"42aa":function(t,e,a){},ad43:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"export-excel-wrapper"},[e("Hints",[e("template",{slot:"hintName"},[t._v("JS-xlsx插件")]),e("template",{slot:"hintInfo"},[e("p",[t._v("JS-xlsx：由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持xlsx、csv、txt等格式")]),e("p",[t._v("github地址：访问 "),e("el-link",{attrs:{type:"success",href:"https://github.com/SheetJS/sheetjs",target:"_blank"}},[t._v("JS-xlsx")])],1)])],2),e("el-card",{attrs:{shadow:"always"}},[e("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:t.exportParam,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"文件名:"}},[e("el-input",{attrs:{placeholder:"文件名"},model:{value:t.exportParam.fileName,callback:function(e){t.$set(t.exportParam,"fileName",e)},expression:"exportParam.fileName"}})],1),e("el-form-item",{attrs:{label:"自动宽度:"}},[e("el-radio-group",{model:{value:t.exportParam.autoWidth,callback:function(e){t.$set(t.exportParam,"autoWidth",e)},expression:"exportParam.autoWidth"}},[e("el-radio",{attrs:{label:!0}},[t._v("自动")]),e("el-radio",{attrs:{label:!1}},[t._v("固定")])],1)],1),e("el-form-item",{attrs:{label:"文件类型:"}},[e("el-select",{attrs:{placeholder:"文件类型"},model:{value:t.exportParam.type,callback:function(e){t.$set(t.exportParam,"type",e)},expression:"exportParam.type"}},[e("el-option",{attrs:{value:"xlsx",label:"xlsx"}}),e("el-option",{attrs:{value:"csv",label:"csv"}}),e("el-option",{attrs:{value:"txt",label:"txt"}})],1)],1),e("el-form-item",[e("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary"},on:{click:t.handleExport}},[t._v("导出Excel")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",size:"medium"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e("el-table-column",{attrs:{prop:"id",label:"编号",align:"center"}}),e("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e("el-table-column",{attrs:{prop:"sex",label:"性别",align:"center"}}),e("el-table-column",{attrs:{prop:"phone",label:"手机",align:"center"}}),e("el-table-column",{attrs:{prop:"education",label:"学历",align:"center"}}),e("el-table-column",{attrs:{prop:"hobby",label:"爱好",align:"center",width:"300"}})],1)],1)],1)},n=[],o=(a("14d9"),a("d722")),i=a("cd77"),s=a("b522"),r={name:"ExportExcel",components:{Hints:s["a"]},data(){return{listLoading:!0,exportParam:{fileName:"",autoWidth:!0,type:"xlsx"},tableData:[],multipleSelection:[]}},created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,Object(o["a"])(this.exportParam).then(t=>{const e=t.data;0===e.code&&(e.data.list.forEach(t=>{const{id:e,name:a,sex:l,phone:n,education:o,hobby:i}=t;this.tableData.push({id:e,name:a,sex:l,phone:n,education:o,hobby:i})}),this.listLoading=!1)}).catch(()=>{this.listLoading=!1})},handleSelectionChange(t){this.multipleSelection=t},handleExport(){if(this.multipleSelection.length){const t={header:["编号","姓名","性别","手机","学历","爱好"],key:["id","name","sex","phone","education","hobby"],data:this.multipleSelection,autoWidth:this.exportParam.autoWidth,fileName:this.exportParam.fileName,bookType:this.exportParam.type};i["a"].exportDataToExcel(t),this.$refs.multipleTable.clearSelection()}else this.$message.warning("请勾选要导出的数据项！")}}},c=r,p=(a("0194"),a("2877")),u=Object(p["a"])(c,l,n,!1,null,null,null);e["default"]=u.exports},b522:function(t,e,a){"use strict";var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hints-wrapper"},[e("div",{staticClass:"hint-title"},[e("i",{staticClass:"vue-dsn-icon-tishi"}),e("span",[t._t("hintName")],2)]),e("div",{staticClass:"hint-info"},[t._t("hintInfo")],2)])},n=[],o={name:"Hints"},i=o,s=(a("3890"),a("2877")),r=Object(s["a"])(i,l,n,!1,null,null,null);e["a"]=r.exports},cd77:function(t,e,a){"use strict";a("907a"),a("986a"),a("1d02"),a("3c5d"),a("1b3b"),a("3d71"),a("c6e3"),a("3c65"),a("14d9");var l=a("1146"),n=a.n(l),o=a("21a6");function i(t,e){const a=e.map(t=>t.map(t=>null==t?{wch:10}:t.toString().charCodeAt(0)>255?{wch:2*t.toString().length}:{wch:t.toString().length})),l=a[0];for(let n=1;n<a.length;n++)for(let t=0;t<a[n].length;t++)l[t].wch<a[n][t].wch&&(l[t].wch=a[n][t].wch);t["!cols"]=l}function s(t,e){return e.map(e=>t.map(t=>e[t]))}function r(t){const e=new ArrayBuffer(t.length),a=new Uint8Array(e);for(let l=0;l!==t.length;++l)a[l]=255&t.charCodeAt(l);return e}function c({header:t,key:e,data:a,fileName:l,autoWidth:c=!0,bookType:p="xlsx"}={}){const u=n.a.utils.book_new(),h=s(e,a);l=l||"excel-list",h.unshift(t);const d=n.a.utils.aoa_to_sheet(h);c&&i(d,h),n.a.utils.book_append_sheet(u,d,l);const m=n.a.write(u,{bookType:p,bookSST:!1,type:"binary"});Object(o["saveAs"])(new Blob([r(m)],{type:"application/octet-stream"}),`${l}.${p}`)}function p(t){const e=[],a=n.a.utils.decode_range(t["!ref"]);let l;const o=a.s.r;for(l=a.s.c;l<=a.e.c;++l){const a=t[n.a.utils.encode_cell({c:l,r:o})];let i="UNKNOWN "+l;a&&a.t&&(i=n.a.utils.format_cell(a)),e.push(i)}return e}function u(t,e){const a=n.a.read(t,{type:e}),l=a.SheetNames[0],o=a.Sheets[l],i=p(o),s=n.a.utils.sheet_to_json(o);return{header:i,results:s}}e["a"]={exportDataToExcel:c,readDataFromExcel:u}},d722:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var l=a("cebe"),n=a.n(l);function o(t){return n()({url:"https://cdn.jsdelivr.net/gh/baimingxuan/media-store/mock-data/table-list.json",method:"get",param:t})}}}]);